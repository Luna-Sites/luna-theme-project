/**
 * Luna Theme - Horizontal Toolbar Styles
 * Clean, modern toolbar design with white background
 */

@use 'variables' as *;

// Body adjustments for Luna toolbar
body.has-toolbar-luna {
  padding-top: $toolbar-height !important;
  padding-left: 0 !important;

  &.has-sidebar {
    padding-left: 375px;
  }

  &.has-sidebar-collapsed {
    padding-left: 20px;
  }

  // Mobile responsive body padding
  @media (max-width: $top-toolbar-mobile-breakpoint) {
    padding-top: 60px !important;
  }

  // Hide the default hamburger menu (we have our own toolbar)
  .hamburger-wrapper {
    display: none !important;
  }
}

// Main Luna Toolbar Container
.luna-toolbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: $toolbar-height;
  background-color: $toolbar-bg;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 $spacing-2xl;
  box-shadow: $shadow-md;
  font-family: $font-family-base;

  // Mobile responsive
  @media (max-width: $top-toolbar-mobile-breakpoint) {
    height: 60px;
    padding: 0 $spacing-md;
  }
}

// Toolbar Sections
.luna-toolbar-left {
  display: flex;
  align-items: center;
  gap: $spacing-md;
  flex-shrink: 0;

  @media (max-width: $top-toolbar-mobile-breakpoint) {
    gap: $spacing-sm;
  }
}

.luna-toolbar-center {
  display: flex;
  align-items: center;
  gap: $toolbar-gap;
  flex: 0 0 auto;
  margin-left: $spacing-2xl;
  background: linear-gradient(to right, $white, $gray-100);
  padding: $spacing-sm;
  border-radius: $border-radius-lg;

  @media (max-width: $top-toolbar-mobile-breakpoint) {
    // On mobile: spread to take available space
    flex: 1;
    margin-left: $spacing-md;
    margin-right: $spacing-md;
    gap: 4px;
    padding: 4px;
    justify-content: space-evenly;
  }
}

// .luna-toolbar-undo-redo {
//   display: flex;
//   align-items: center;
//   gap: $toolbar-gap;
//   margin-left: $spacing-md;
//   flex-shrink: 0;
//   // White background (no gradient)
// }

.luna-toolbar-right {
  display: flex;
  align-items: center;
  gap: $toolbar-gap;
  margin-left: auto;
  flex-shrink: 0;
  // Empty section for sidebar space
}

// Logo Component Styles
.luna-logo-wrapper {
  text-decoration: none;
  color: inherit;
  display: flex;
  align-items: center;
  transition: opacity $transition-fast;
  position: relative;

  // Tooltip on hover
  &::after {
    content: attr(aria-label);
    position: absolute;
    bottom: -35px;
    left: 50%;
    transform: translateX(-50%);
    background-color: $white;
    color: $gray-900;
    padding: 6px 12px;
    border-radius: $border-radius-sm;
    font-size: $font-size-sm;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity $transition-fast;
    z-index: 10;
    box-shadow: $shadow-md;
  }

  // Show tooltip on hover
  &:hover::after {
    opacity: 1;
  }

  &:hover {
    opacity: 1;
  }
}

.luna-logo {
  display: flex;
  align-items: center;
  gap: $spacing-md;

  @media (max-width: $top-toolbar-mobile-breakpoint) {
    svg,
    .luna-logo-icon svg {
      width: 28px !important;
      height: 28px !important;
    }
  }
}

.luna-logo-icon {
  svg {
    fill: none !important;
  }
}

// Purple moon for light theme
body.has-toolbar-luna .luna-logo-moon,
.luna-logo-moon {
  svg,
  svg.icon {
    stroke: $luna-purple !important;
    stroke-width: 1.8 !important;
    color: $luna-purple !important;

    path,
    circle,
    line {
      stroke: $luna-purple !important;
      color: $luna-purple !important;
    }
  }
}

// White sun for dark theme
body.has-toolbar-luna.theme-dark .luna-logo-sun,
.luna-logo-sun {
  svg,
  svg.icon {
    stroke: white !important;
    stroke-width: 2.5 !important;
    color: white !important;

    path,
    circle,
    line {
      stroke: white !important;
      color: white !important;
    }
  }
}

.luna-site-title {
  font-size: $font-size-lg;
  font-weight: $font-weight-semibold;
  color: $gray-900;
  white-space: nowrap;
}

// Toolbar Buttons
.luna-toolbar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: $toolbar-button-size;
  height: $toolbar-button-size;
  background-color: transparent;
  border: none;
  border-radius: $border-radius-md;
  cursor: pointer;
  transition: all $transition-fast;
  color: $toolbar-icon-color;
  text-decoration: none;
  padding: 0;
  flex-shrink: 0;
  position: relative;

  // Icon styling
  svg {
    width: $toolbar-icon-size;
    height: $toolbar-icon-size;
    stroke: currentColor;
    stroke-width: 1.8;
    fill: none !important;
    transition: all $transition-fast;
  }

  // Mobile responsive - smaller buttons
  @media (max-width: $top-toolbar-mobile-breakpoint) {
    width: 36px;
    height: 36px;

    svg {
      width: 20px;
      height: 20px;
    }
  }

  // Tooltip on hover
  &::after {
    content: attr(aria-label);
    position: absolute;
    bottom: -35px;
    left: 50%;
    transform: translateX(-50%);
    background-color: $white;
    color: $gray-900;
    padding: 6px 12px;
    border-radius: $border-radius-sm;
    font-size: $font-size-sm;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity $transition-fast;
    z-index: 10;
    box-shadow: $shadow-md;
  }

  // Show tooltip on hover
  &:hover::after {
    opacity: 1;
  }

  // Hover state
  &:hover {
    background-color: $toolbar-hover-bg;
    color: $luna-purple;

    svg {
      stroke: $luna-purple;
    }
  }

  // Focus state
  &:focus,
  &:focus-visible {
    outline: 2px solid $luna-purple;
    outline-offset: 2px;
  }

  // Active/selected state (for Edit button)
  &.active {
    background-color: $toolbar-active-bg;
    color: $toolbar-active-icon;

    svg {
      stroke: $toolbar-active-icon;
    }

    &:hover {
      background-color: $luna-purple-dark;
      color: $toolbar-active-icon;
    }
  }

  // Disabled state
  &:disabled {
    opacity: 0.4;
    cursor: not-allowed;

    &:hover {
      background-color: transparent;
    }
  }
}

// Special button spacing for More button
.luna-toolbar-center {
  .luna-toolbar-button:last-child {
    margin-left: $spacing-sm;
  }
}

// Edit Mode Buttons (Save/Cancel) - Preserve SVG fill colors
.luna-edit-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: $toolbar-button-size;
  height: $toolbar-button-size;
  background-color: transparent;
  border: none;
  border-radius: $border-radius-md;
  cursor: pointer;
  transition: all $transition-fast;
  text-decoration: none;
  padding: 0;
  flex-shrink: 0;
  position: relative;

  // IMPORTANT: Allow SVG fill colors (don't override with stroke)
  svg {
    width: $toolbar-icon-size;
    height: $toolbar-icon-size;
    // No stroke or fill overrides - let the SVG colors show through
    transition: all $transition-fast;
  }

  // Mobile responsive - smaller buttons
  @media (max-width: $top-toolbar-mobile-breakpoint) {
    width: 36px;
    height: 36px;

    svg {
      width: 20px;
      height: 20px;
    }
  }

  // Tooltip on hover
  &::after {
    content: attr(aria-label);
    position: absolute;
    bottom: -35px;
    left: 50%;
    transform: translateX(-50%);
    background-color: $white;
    color: $gray-900;
    padding: 6px 12px;
    border-radius: $border-radius-sm;
    font-size: $font-size-sm;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity $transition-fast;
    z-index: 10;
    box-shadow: $shadow-md;
  }

  // Show tooltip on hover
  &:hover::after {
    opacity: 1;
  }

  // Hover state - lighten background
  &:hover {
    background-color: $toolbar-hover-bg;
  }

  // Focus state
  &:focus,
  &:focus-visible {
    outline: 2px solid $luna-purple;
    outline-offset: 2px;
  }

  // Disabled state
  &:disabled {
    opacity: 0.4;
    cursor: not-allowed;

    &:hover {
      background-color: transparent;
    }
  }
}

// Cancel button - ensure red color
.luna-cancel-button {
  svg {
    stroke: #ef4444 !important;
    stroke-width: 2.2;
    fill: none !important;
  }
}

// Dropdown Menu Content
// TODO: Customize later - for now using Volto defaults
// .luna-toolbar-content {
//   position: fixed;
//   top: $toolbar-height;
//   left: 0;
//   right: 0;
//   background-color: $white;
//   box-shadow: $shadow-lg;
//   max-height: 0;
//   overflow: hidden;
//   transition: max-height $transition-base;
//   z-index: 2;
//
//   &.show {
//     max-height: calc(100vh - #{$toolbar-height});
//     overflow-y: auto;
//   }
// }

// Pusher-puller for menu navigation
.luna-pusher-puller {
  display: flex;
  transition: transform $transition-base;
  width: 100%;
  min-height: 200px;

  > * {
    min-width: 100%;
    flex-shrink: 0;
  }
}

// Hide the old toolbar and pusher
body.has-toolbar-luna {
  .toolbar:not(.luna-toolbar),
  .pusher:not(.luna-pusher-puller) {
    display: none !important;
  }

  // Ensure content doesn't overlap with toolbar
  #main {
    padding-top: 0;
  }
}

// Dark theme adjustments (when implemented)
body.has-toolbar-luna.theme-dark {
  .luna-toolbar {
    background-color: $gray-900;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
  }

  .luna-site-title {
    color: $white;
  }

  .luna-toolbar-center {
    // Gradient from dark gray to semi-transparent purple (30% opacity)
    background: linear-gradient(to right, $gray-900, rgba(124, 58, 237, 0.3));

    @media (max-width: $top-toolbar-mobile-breakpoint) {
      // Keep the gradient on mobile too
      background: linear-gradient(to right, $gray-900, rgba(124, 58, 237, 0.3));
    }
  }

  .luna-toolbar-button {
    color: $white;

    &:hover {
      background-color: rgba(255, 255, 255, 0.1);
      color: $white;
    }

    &.active {
      background-color: $luna-purple;
      color: $white;
    }
  }

  .luna-toolbar-content {
    background-color: $gray-800;
  }
}
